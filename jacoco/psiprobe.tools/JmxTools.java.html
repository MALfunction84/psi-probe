<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JmxTools.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">psi-probe-core</a> &gt; <a href="index.source.html" class="el_package">psiprobe.tools</a> &gt; <span class="el_source">JmxTools.java</span></div><h1>JmxTools.java</h1><pre class="source lang-java linenums">/*
 * Licensed under the GPL License. You may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   https://www.gnu.org/licenses/old-licenses/gpl-2.0.html
 *
 * THIS PACKAGE IS PROVIDED &quot;AS IS&quot; AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING,
 * WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE.
 */
package psiprobe.tools;

import javax.management.AttributeNotFoundException;
import javax.management.InstanceNotFoundException;
import javax.management.IntrospectionException;
import javax.management.MBeanAttributeInfo;
import javax.management.MBeanException;
import javax.management.MBeanInfo;
import javax.management.MBeanServer;
import javax.management.ObjectName;
import javax.management.ReflectionException;
import javax.management.RuntimeOperationsException;
import javax.management.openmbean.CompositeData;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * The Class JmxTools.
 */
public final class JmxTools {

  /** The Constant logger. */
<span class="nc" id="L34">  private static final Logger logger = LoggerFactory.getLogger(JmxTools.class);</span>

  /**
   * Prevent Instantiation.
   */
  private JmxTools() {
    // Prevent Instantiation
  }

  /**
   * Gets the attribute. All exceptions default to null.
   *
   * @param mbeanServer the mbean server
   * @param objectName the object name
   * @param attributeName the attribute name
   *
   * @return the attribute
   */
  public static Object getAttribute(MBeanServer mbeanServer, ObjectName objectName,
      String attributeName) {
    try {
<span class="nc" id="L55">      return mbeanServer.getAttribute(objectName, attributeName);</span>
<span class="nc" id="L56">    } catch (AttributeNotFoundException e) {</span>
<span class="nc" id="L57">      logger.error(&quot;MBean Object '{}' does not have '{}' attribute&quot;, objectName, attributeName);</span>
<span class="nc" id="L58">      logger.trace(&quot;&quot;, e);</span>
<span class="nc" id="L59">    } catch (RuntimeOperationsException e) {</span>
<span class="nc" id="L60">      logger.error(&quot;MBean Object '{}' or Attribute '{}' are null&quot;, objectName, attributeName);</span>
<span class="nc" id="L61">      logger.trace(&quot;&quot;, e);</span>
<span class="nc" id="L62">    } catch (InstanceNotFoundException e) {</span>
<span class="nc" id="L63">      logger.error(&quot;MBean Object '{}' not registered&quot;, objectName);</span>
<span class="nc" id="L64">      logger.trace(&quot;&quot;, e);</span>
<span class="nc" id="L65">    } catch (MBeanException | ReflectionException e) {</span>
<span class="nc" id="L66">      logger.error(&quot;MBean Object '{}' not accessible&quot;, objectName);</span>
<span class="nc" id="L67">      logger.trace(&quot;&quot;, e);</span>
<span class="nc" id="L68">    }</span>
<span class="nc" id="L69">    return null;</span>
  }

  /**
   * Invoke mbean server method. All exceptions default to null.
   *
   * @param mbeanServer the mbean server
   * @param objectName the object name
   * @param method the method
   * @param parameters the parameters
   * @param signatures the signatures
   *
   * @return the object
   */
  public static Object invoke(MBeanServer mbeanServer, ObjectName objectName, String method,
      Object[] parameters, String[] signatures) {
    try {
<span class="nc" id="L86">      return mbeanServer.invoke(objectName, method, parameters, signatures);</span>
<span class="nc" id="L87">    } catch (InstanceNotFoundException e) {</span>
<span class="nc" id="L88">      logger.error(&quot;MBean Object '{}' not registered&quot;, objectName);</span>
<span class="nc" id="L89">      logger.trace(&quot;&quot;, e);</span>
<span class="nc" id="L90">    } catch (MBeanException | ReflectionException e) {</span>
<span class="nc" id="L91">      logger.error(&quot;MBean Object '{}' not accessible&quot;, objectName);</span>
<span class="nc" id="L92">      logger.trace(&quot;&quot;, e);</span>
<span class="nc" id="L93">    }</span>
<span class="nc" id="L94">    return null;</span>
  }

  /**
   * Gets the long attribute. Default value used if null or any exceptions.
   *
   * @param mbeanServer the mbean server
   * @param objectName the object name
   * @param attributeName the attribute name
   * @param defaultValue the default value
   *
   * @return the long attr
   */
  public static long getLongAttr(MBeanServer mbeanServer, ObjectName objectName,
      String attributeName, long defaultValue) {
<span class="nc" id="L109">    Object object = JmxTools.getAttribute(mbeanServer, objectName, attributeName);</span>
<span class="nc bnc" id="L110" title="All 2 branches missed.">    return object == null ? defaultValue : (Long) object;</span>
  }

  /**
   * Gets the long attribute. Default value '0' if null or any exceptions.
   *
   * @param compositeData the composite data
   * @param name the name
   *
   * @return the long attribute
   */
  public static long getLongAttr(CompositeData compositeData, String name) {
<span class="nc" id="L122">    Object object = compositeData.get(name);</span>
<span class="nc bnc" id="L123" title="All 2 branches missed.">    return object instanceof Long ? (Long) object : 0;</span>
  }

  /**
   * Gets the long attribute. Default value '0' if null or any exceptions.
   *
   * @param mbeanServer the mbean server
   * @param objectName the object name
   * @param attributeName the attribute name
   *
   * @return the long attribute
   */
  public static long getLongAttr(MBeanServer mbeanServer, ObjectName objectName,
      String attributeName) {
<span class="nc" id="L137">    Object object = JmxTools.getAttribute(mbeanServer, objectName, attributeName);</span>
<span class="nc bnc" id="L138" title="All 2 branches missed.">    return object == null ? 0 : (Long) object;</span>
  }

  /**
   * Gets the int attribute. Default value '0' if null or any exceptions.
   *
   * @param mbeanServer the mbean server
   * @param objectName the object name
   * @param attributeName the attribute name
   *
   * @return the int attribute
   */
  public static int getIntAttr(MBeanServer mbeanServer, ObjectName objectName,
      String attributeName) {
<span class="nc" id="L152">    Object object = JmxTools.getAttribute(mbeanServer, objectName, attributeName);</span>
<span class="nc bnc" id="L153" title="All 2 branches missed.">    return object == null ? 0 : (Integer) object;</span>
  }

  /**
   * Gets the int attribute. Default to default value if not found.
   *
   * @param compositeData the composite data
   * @param name the name
   * @param defaultValue the default value
   *
   * @return the int attribute
   */
  public static int getIntAttr(CompositeData compositeData, String name, int defaultValue) {
<span class="nc" id="L166">    Object object = compositeData.get(name);</span>
<span class="nc bnc" id="L167" title="All 2 branches missed.">    return object instanceof Integer ? (Integer) object : defaultValue;</span>
  }

  /**
   * Gets the string attribute. All exceptions default to null.
   *
   * @param mbeanServer the mbean server
   * @param objectName the object name
   * @param attributeName the attribute name
   *
   * @return the string attribute
   */
  public static String getStringAttr(MBeanServer mbeanServer, ObjectName objectName,
      String attributeName) {
<span class="nc" id="L181">    Object object = JmxTools.getAttribute(mbeanServer, objectName, attributeName);</span>
<span class="nc bnc" id="L182" title="All 2 branches missed.">    return object == null ? null : object.toString();</span>
  }

  /**
   * Gets the string attribute.
   *
   * @param compositeData the composite data
   * @param name the name
   *
   * @return the string attribute
   */
  public static String getStringAttr(CompositeData compositeData, String name) {
<span class="nc" id="L194">    Object object = compositeData.get(name);</span>
<span class="nc bnc" id="L195" title="All 2 branches missed.">    return object == null ? null : object.toString();</span>
  }

  /**
   * Gets the boolean attribute. All exceptions default to false.
   *
   * @param mbeanServer the mbean server
   * @param objectName the object name
   * @param attributeName the attribute name
   *
   * @return the string attribute
   */
  public static boolean getBooleanAttr(MBeanServer mbeanServer, ObjectName objectName,
      String attributeName) {
<span class="nc" id="L209">    Object object = JmxTools.getAttribute(mbeanServer, objectName, attributeName);</span>
<span class="nc bnc" id="L210" title="All 4 branches missed.">    return object instanceof Boolean &amp;&amp; (Boolean) object;</span>
  }

  /**
   * Gets the boolean attribute.
   *
   * @param compositeData the composite data
   * @param name the name
   *
   * @return the boolean attribute
   */
  public static boolean getBooleanAttr(CompositeData compositeData, String name) {
<span class="nc" id="L222">    Object object = compositeData.get(name);</span>
<span class="nc bnc" id="L223" title="All 4 branches missed.">    return object instanceof Boolean &amp;&amp; (Boolean) object;</span>
  }

  /**
   * Checks for attribute. All exceptions default to false.
   *
   * @param server the server
   * @param mbean the mbean
   * @param attributeName the attribute name
   *
   * @return true, if successful
   */
  public static boolean hasAttribute(MBeanServer server, ObjectName mbean, String attributeName) {
    try {
<span class="nc" id="L237">      MBeanInfo info = server.getMBeanInfo(mbean);</span>
<span class="nc bnc" id="L238" title="All 2 branches missed.">      for (MBeanAttributeInfo attributeInfo : info.getAttributes()) {</span>
<span class="nc bnc" id="L239" title="All 2 branches missed.">        if (attributeInfo.getName().equals(attributeName)) {</span>
<span class="nc" id="L240">          return true;</span>
        }
      }
<span class="nc" id="L243">    } catch (InstanceNotFoundException e) {</span>
<span class="nc" id="L244">      logger.error(&quot;MBean Object '{}' not registered&quot;, mbean);</span>
<span class="nc" id="L245">      logger.trace(&quot;&quot;, e);</span>
<span class="nc" id="L246">    } catch (IntrospectionException | ReflectionException e) {</span>
<span class="nc" id="L247">      logger.error(&quot;MBean Object '{}' not accessible&quot;, mbean);</span>
<span class="nc" id="L248">      logger.trace(&quot;&quot;, e);</span>
<span class="nc" id="L249">    }</span>
<span class="nc" id="L250">    return false;</span>
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>